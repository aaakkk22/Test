{include file="public:header"/}

<body layadmin-themealias="default">
	<div class="layui-fluid">
		<div class="layui-card">
			<div class="layui-card-header layui-elem-quote">当前位置：<span class="line-text">添加客户</span></div>
			<div class="layui-card-body" style="padding:15px;">
				<form action="" method="post" class="layui-form" lay-filter="component-layui-form-item"
					enctype="multipart/form-data">
					<input type="hidden" name="is_showform" value="" />

					<div class="layui-tab layui-tab-brief" lay-filter="docDemoTabBrief">
						<ul class="layui-tab-title">
							<li class="layui-this">添加客户</li>
						</ul>
						<div class="layui-tab-content">
							<div class="layui-tab-item layui-show">

								<!--- begin -->
								<div class="layui-form-item">
									<label class="layui-form-label">客户姓名</label>
									<div class="layui-input-block">
										<input type="text" name="data[username]" class="form-control"
											value="{$list.username}" style="width: 300px;" lay-verify="required"/>
									</div>
								</div>
								
								<div class="layui-form-item">
									<label class="layui-form-label">地址</label>
									<div class="layui-input-block">
										<input type="text" name="data[address]" class="form-control"
											value="{$list.address}" style="width: 300px;" lay-verify="required"/>
									</div>
								</div>

								<div class="layui-form-item">
									<label class="layui-form-label must">客户头像</label>
									<div class="layui-input-block gimgs">
										<div class="input-group " style="width: 300px;">
											<input type="text" name="data[image]" id="image" value="{$list.image}"
												class="form-control" autocomplete="off">
											<span class="input-group-btn">
												<button class="btn btn-primary" type="button"
													onclick="GetUploadify(1,'','video','call_back');">选择图片</button>
											</span>
										</div>
										<div class="input-group " style="margin-top:.5em;">
											<img id="image2" src="{$list.image}"
												onerror="this.src='/static/images/nopic.png'; this.title='图片未找到.'"
												class="img-responsive img-thumbnail" width="150">
											<em class="close" style="position:absolute; top: 0px; right: -14px;" title="删除这张图片"
												onclick="deleteImage(this)">×</em>
										</div>
										<span class="layui-form-mid layui-word-aux image-block">长方形png图标，最佳尺寸:400*730</span>
									</div>
								</div>

								<script>
									// 上传商品图片成功回调函数
									function call_back(fileurl_tmp) {
										console.log(fileurl_tmp);
										$("#image").val(fileurl_tmp);
										$("#image2").attr('src', fileurl_tmp);
									}
									//删除图片
									function deleteImage() {
										layer.msg('不支持删除，重新选择图片进行替换即可', {
											time: 1000
										});
									}
								</script>
			
								<div class="layui-form-item">
									<label class="layui-form-label">手机号</label>
									<div class="layui-input-block">
										<input type="text" name="data[phone]" class="form-control"
											value="{$list.phone}" style="width: 300px;" lay-verify="required"/>
									</div>
								</div>
								<!-- end -->
							</div>
						</div>
					</div>

					<div class="layui-form-item">
						<label class="layui-form-label"> </label>
						<div class="layui-input-block">
							<input type="submit" value="提交" lay-submit lay-filter="formDemo" class="btn btn-primary" />
							&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
							<a class="btn btn-default" style='margin-left:10px;' onclick="history.go(-1)">返回列表</a>

						</div>
					</div>
				</form>
			</div>
		</div>
	</div>

	<script>
		//由于模块都一次性加载，因此不用执行 layui.use() 来加载对应模块，直接使用即可：
		var layer = layui.layer;
		var $;
		var cur_open_div;	
		layui.use(['jquery', 'layer', 'form'], function () {
			$ = layui.$;
			var form = layui.form;
			//监听提交
			form.on('submit(formDemo)', function (data) {

				$.ajax({
					url: data.form.action,
					type: data.form.method,
					data: data.field,
					dataType: 'json',
					success: function (data) {
						code = 1;
						if (data.status == 1) {
							layer.alert(data.msg, {
								icon: 1
							},
								function () {
									window.location.href = "{:url('member/member_list')}";
								});
						} else {
							layer.msg(data.msg, { icon: 2, time: 3000 });
						}
					}
				});

				return false;
			});
		})
	</script>
</body>